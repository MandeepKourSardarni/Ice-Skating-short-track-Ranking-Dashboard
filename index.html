<!DOCTYPE html>
<html>
<head>
<title>Ice Skating Short Track Ranking Dashboard</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>

/* --------------------------------------------------
    GLOBAL + BACKGROUND
--------------------------------------------------*/

body {
    margin:0;
    padding:0;
    font-family:'Segoe UI',Arial,sans-serif;
    background: transparent !important;
    color:white;
}

.bg {
    background-image:url("https://raw.githubusercontent.com/MandeepKourSardarni/Ice-Skating-short-track-Ranking-Dashboard/main/image.jpg?raw=1");
    background-size:cover;
    background-position:center;
    background-attachment:fixed;
    position:fixed;
    inset:0;
    z-index:-3;
}

.bgOverlay {
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.25);
    z-index:-2;
}

/* --------------------------------------------------
      SLIDING TOGGLE SWITCH
--------------------------------------------------*/

.theme-toggle-wrapper {
    display:flex;
    align-items:center;
    justify-content:center;
}

.theme-switch {
    --h: 24px;
    --w: 48px;

    width:var(--w);
    height:var(--h);
    border-radius:var(--h);
    background:#ddd;
    position:relative;
    cursor:pointer;
    transition:0.3s;
    border:none;
}

.theme-switch .slider {
    width:calc(var(--h) - 6px);
    height:calc(var(--h) - 6px);
    background:white;
    border-radius:50%;
    position:absolute;
    top:3px;
    left:3px;
    transition:0.3s ease;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:14px;
}

.theme-switch.dark {
    background:#222;
}

.theme-switch.dark .slider {
    transform:translateX(24px);
    background:#fff;
}

.sun { display:none; }
.moon { display:block; }

.dark .sun { display:block; }
.dark .moon { display:none; }

/* --------------------------------------------------
    LIGHT + DARK MODE OVERRIDES
--------------------------------------------------*/

.light-mode body { color:black !important; }

.light-mode .headerBar,
.light-mode .control-col,
.light-mode .viewBar,
.light-mode table {
    background:rgba(255,255,255,0.75) !important;
    color:black !important;
}

.light-mode th {
    background:rgba(0,80,160,0.8) !important;
}

.light-mode td,
.light-mode .name,
.light-mode .rank {
    color:black !important;
}

/* Dark Mode */

.dark-mode body { color:white !important; }

.dark-mode .headerBar,
.dark-mode .control-col,
.dark-mode .viewBar,
.dark-mode table {
    background:rgba(40,40,40,0.55) !important;
    color:white !important;
}

.dark-mode th {
    background:rgba(0,60,120,0.8) !important;
}

.dark-mode td,
.dark-mode .name,
.dark-mode .rank {
    color:white !important;
}

/* --------------------------------------------------
           HEADER BAR
--------------------------------------------------*/

.headerBar {
    width:90%;
    margin:25px auto 20px auto;
    padding:15px;
    text-align:center;
    background:rgba(255,255,255,0.08);
    border-radius:12px;
    backdrop-filter:blur(14px);
    box-shadow:0 0 16px rgba(0,0,0,0.4);
    position:relative;
}

h1 {
    margin:0;
    font-size:34px;
    font-weight:700;
    text-shadow:0 0 12px rgba(0,160,255,0.7);
}

/* --------------------------------------------------
          CONTROL PANEL
--------------------------------------------------*/

.control-row {
    width:95%;
    display:flex;
    gap:18px;
    margin:0 auto;
    justify-content:space-between;
    flex-wrap:wrap;
}

.control-col {
    flex:1;
    min-width:290px;
    padding:10px 14px;
    background:rgba(255,255,255,0.09);
    border-radius:12px;
    backdrop-filter:blur(14px);
    display:flex;
    align-items:center;
    justify-content:center;
    gap:12px;
    box-shadow:0 0 16px rgba(0,0,0,0.4);
}

input, select, button {
    height:36px;
    padding:4px 10px;
    border-radius:6px;
    border:none;
    font-size:14px;
}

input, select {
    background:rgba(255,255,255,0.85);
    color:black;
}

button {
    background:#1e90ff;
    color:white;
    cursor:pointer;
}

button:hover { background:#5ab3ff; }

.danger { background:#ff4d4d !important; }
.danger:hover { background:#ff7979 !important; }

/* --------------------------------------------------
   SCOREBOARD TABLE
--------------------------------------------------*/

.viewBar {
    width:90%;
    margin:25px auto 0 auto;
    padding:15px;
    background:rgba(255,255,255,0.09);
    border-radius:12px;
    text-align:center;
    backdrop-filter:blur(14px);
}

table {
    width:95%;
    margin:25px auto;
    border-collapse:collapse;
    background:rgba(255,255,255,0.07);
    backdrop-filter:blur(12px);
    border-radius:14px;
    overflow:hidden;
}

th, td {
    text-align:center;
    padding:12px;
}

th {
    background:rgba(0,60,120,0.7);
    font-size:17px;
}

td.name { text-align:left; padding-left:12px; }

/* --------------------------------------------------
        POPUP WINDOWS
--------------------------------------------------*/

#excelErrorPopup {
    position:fixed;
    left:50%;
    top:-300px;
    transform:translateX(-50%);
    width:90%;
    max-width:420px;
    background:rgba(0,0,0,0.92);
    padding:20px;
    border-radius:12px;
    color:white;
    text-align:center;
    z-index:200;
    animation-duration:0.7s;
    animation-fill-mode:forwards;
}

@keyframes slideDown {
    from { top:-300px; opacity:0; }
    to   { top:120px; opacity:1; }
}

#editNamePopup,
#helpPopup {
    position:fixed;
    top:50%; left:50%;
    transform:translate(-50%,-50%);
    background:#111;
    padding:20px;
    width:90%; max-width:400px;
    border-radius:12px;
    color:white;
    text-align:center;
    display:none;
    z-index:300;
}

</style>
</head>

<body>

<div class="bg"></div>
<div class="bgOverlay"></div>

<div class="headerBar">
    <h1>Ice Skating Short Track Ranking Dashboard</h1>
</div>

<!-- CONTROL PANELS -->
<div class="control-row">

    <div class="control-col">
        <input type="file" id="excelFile" accept=".xls,.xlsx">
        <button onclick="uploadExcel()">Upload Excel</button>
    </div>

    <div class="control-col">
        <input id="skaterName" placeholder="Manually enter the name">
        <button onclick="addManual()">Add</button>
        <select id="addGroupSelect">
            <option>Alpha</option><option>Bravo</option><option>Charlie</option>
            <option>Delta</option><option>Echo</option><option>Foxtrot</option>
            <option>Golf</option><option>Hotel</option><option>India</option>
        </select>
    </div>

    <div class="control-col">
        <button class="danger" onclick="resetGroup()">Reset Group</button>
        <button class="danger" onclick="resetAll()">Reset All Groups</button>
        <button onclick="openHelp()">Help / Instructions</button>

        <!-- SLIDING THEME TOGGLE -->
        <div class="theme-toggle-wrapper">
            <button id="themeToggle" class="theme-switch">
                <div class="slider">
                    <span class="moon">üåô</span>
                    <span class="sun">‚òÄÔ∏è</span>
                </div>
            </button>
        </div>
    </div>

</div>

<!-- SCOREBOARD SECTION -->
<div class="viewBar">
    <label style="font-size:18px;font-weight:bold;">Select Group to View Scoreboard</label><br>
    <select id="viewGroupSelect" onchange="switchGroup()" style="width:220px;margin-top:8px;">
        <option>Alpha</option><option>Bravo</option><option>Charlie</option>
        <option>Delta</option><option>Echo</option><option>Foxtrot</option>
        <option>Golf</option><option>Hotel</option><option>India</option>
    </select>
</div>

<table id="scoreTable">
    <thead>
        <tr>
            <th>Name</th>
            <th>400</th><th>500</th><th>800</th><th>1000</th><th>1500</th>
            <th>Total</th><th>Rank</th>
            <th>Undo / Delete</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<!-- POPUPS -->
<div id="excelErrorPopup">
    <p><b><i>
        SORRY IF THE EXCEL FILE DOES NOT UPLOAD PROPERLY.<br>
        PLEASE TRY ENTERING NAMES MANUALLY.
    </i></b></p>
    <button onclick="closeExcelErrorPopup()">Close</button>
</div>

<div id="editNamePopup">
    <h2>Edit Name</h2>
    <input id="editNameInput">
    <br><br>
    <button onclick="saveEditedName()">Save</button>
    <button class="danger" onclick="closeEditName()">Cancel</button>
</div>

<div id="helpPopup">
    <h2>Instructions</h2>
    <p>‚Ä¢ Upload Excel to auto-add skaters.</p>
    <p>‚Ä¢ Enter race positions to calculate points.</p>
    <p>‚Ä¢ Rankings update automatically.</p>
    <p>‚Ä¢ Undo only undoes last change.</p>
    <button onclick="closeHelp()">Close</button>
</div>


<script>

/* --------------------------------------------------
      THEME SWITCH (SLIDER)
--------------------------------------------------*/

const toggleBtn = document.getElementById("themeToggle");

// Load saved preference
let savedTheme = localStorage.getItem("theme") || "dark";
applyTheme(savedTheme);

toggleBtn.onclick = () => {
    let newTheme = document.body.classList.contains("dark-mode") ? "light" : "dark";
    applyTheme(newTheme);
};

function applyTheme(mode) {
    if (mode === "light") {
        document.body.classList.remove("dark-mode");
        document.body.classList.add("light-mode");
        toggleBtn.classList.remove("dark");
    } else {
        document.body.classList.remove("light-mode");
        document.body.classList.add("dark-mode");
        toggleBtn.classList.add("dark");
    }
    localStorage.setItem("theme", mode);
}

/* --------------------------------------------------
      EXISTING LOGIC (UNCHANGED)
--------------------------------------------------*/

function showExcelErrorPopup(){
    document.getElementById("excelErrorPopup").style.display="bl
